<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<style>
li:hover{
    background-color: lightblue;
    display: inline-block;
    
}
</style>
</head>

<body>
    <div class="wrapper">
        <input id="email-input" type="text">
        <ul id="email-sug-wrapper" class="email-sug"></ul>
    </div>
    <script>
        var postfixList = ['@163.com', '@gmail.com', '@126.com', '@qq.com', '@263.net'];
        for (let i = 0; i < postfixList.length; i++) {
            var li = document.createElement('li');
            li.style.listStyle = 'none';
            var textnode = document.createTextNode('');
            li.appendChild(textnode);
            document.querySelector('ul').appendChild(li);
        }

        window.onload=function(){
            var ul=document.getElementById('email-sug-wrapper');
            ul.onclick=function(ev){
                var ev=ev||window.event;
                var target=ev.target||ev.srcElement;
                if(target.nodeName.toLowerCase()=='li'){
               var tipContent=target.childNodes[0].nodeValue;
               document.getElementById('email-input').value=tipContent;
               document.getElementById('email-sug-wrapper').style.display = "none";
                }
            }

        }
        document.getElementById('email-input').oninput = function () {     //onkeypress备选方案
            tips();
            isDisplay();

        }
        function getUserEmail() {
            var userEmail = document.getElementById('email-input').value;
            return userEmail.trim();
        }

        function tips() {
            var textnode;

            for (let i = 0; i < postfixList.length; i++) {
                if (getUserEmail().indexOf('@') != -1) {                //当@出现时
                        document.getElementById('email-sug-wrapper').childNodes[i].style.display = 'none';
               


                    var index = getUserEmail().indexOf('@');
                    var text = getUserEmail().slice(0, index);
                    textnode = text + postfixList[i];
                    var textAfter = getUserEmail().slice(index, getUserEmail().length);

                    if(postfixList[i].indexOf(textAfter)!=-1){
                        document.querySelector('ul').childNodes[i].style.display='';
                    }



                }
                else {
                    textnode = getUserEmail() + postfixList[i];
                }
                document.querySelector('ul').childNodes[i].childNodes[0].nodeValue = textnode;
            }

        }
        function add2Wrapper() {
            document.getElementById('email-sug-wrapper').appendChild(tips());
        }
        function isDisplay() {
            var userEmail = document.getElementById('email-input').value;

            if (userEmail == "") {
                document.getElementById('email-sug-wrapper').style.display = 'none';
            }
            else {
                document.getElementById('email-sug-wrapper').style.display = "";

            }

        }
        isDisplay();

    </script>
</body>

</html>